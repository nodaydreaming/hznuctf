/*var users_list=[{"id" : 1,"username" : "wenzhou","password" : "lzypcx321","nickname" : "闻舟","academy" : "杭州国际服务工程学院","class" : "计算机173","name" : "骆闻舟","tel" : "15990832293","number" : "2017212212136","email" : "1608425104@qq.com","gender" : 1},
                {"id" : 2,"username" : "qizui","password" : "qizui321","nickname" : "舟舟","academy" : "理学院","class" : "计算机173","name" : "费渡","tel" : "15236985236","number" : "2017125874126","email" : "3335138651@qq.com","gender" : 1},
                {"id" : 3,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 4,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 5,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 6,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 7,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 8,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 9,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 10,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 11,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 12,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 13,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 14,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 15,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 16,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 17,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 18,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 19,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 20,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 21,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 22,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 23,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 24,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 25,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 26,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 27,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 28,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 29,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 30,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 31,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 32,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 33,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 34,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 35,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 36,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 37,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 38,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 39,"username" : "zhuyilong","nickname" : "拢龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
                {"id" : 40,"username" : "zhuyilong","nickname" : "龙","password" : "zhuyilong321","academy" : "医学院","class" : "计算机173","name" : "朱一龙","tel" : "15990832293","number" : "2018212212136","email" : "1608425104@163.com","gender" : 0},
];*/
var users_list;
var user_username,user_nickname, user_academy,  user_class, user_name, user_tel, user_number, user_email, user_gender;
var original_academychoice, original_genderchoice,  user_nwepwd, user_comfirmPwd ,use_oldpwd;

/*layui.use('element', function(){
    var element = layui.element; //导航的hover效果、二级菜单等功能，需要依赖element模块
    //监听导航点击
    element.on('nav(demo)', function(elem){
        //console.log(elem)
        layer.msg(elem.text());
    });
    //一些事件监听*/
    
window.onload = function () {
    // 此ajax不适用于main.html页面获取管理员信息
    
    $.ajax({
        url: '../../../admin/getAdminMap',//获取管理员个人信息
        type: 'post',
        scriptCharset: 'utf-8',
        success: function (result) {
            // console.log(result);
            var loginAdmin = result.loginAdmin;
            //设置登陆用户的昵称
            if (loginAdmin.adminNickname != null) {
                ($('.layui-nav-img')[0].parentNode).childNodes[2].data = loginAdmin.adminNickname;
            }
            //设置登陆用户的头像
            if (loginAdmin.adminImage != null) {
                $('.layui-nav-img').attr("src", loginAdmin.adminImage);
            }
        },
        error: function () {
            layer.msg("请求失败！");
        }
    });
    //fill_users();     //测试完毕改成get_users();！！！！！
    get_users();
};

//获得用户列表
function get_users(){
    $.ajax({
        url : '../../../user/listUser',//获得用户列表
        type : 'post',
        scriptCharset : 'utf-8',
        success : function (result) {
            if(result.status == "success") {
                users_list = result.userList;
                // console.log(problem_list);
                fill_users();
            }
            else{
                layer.msg(result.message);
            }
        },
        error : function(){
            layer.msg("请求题目信息失败！");
        }
    });
}


function search(){
    var keywords = document.getElementById("demoReload").value;
    //console.log(keywords);
    $.ajax({
        url: '../../../user/queryUserByuserAccount', //根据用户名查询
        data: {
            'userAccount': keywords
        },
        type: 'POST',
        scriptCharset : 'utf-8',  
        success : function(result){
            console.log(result);
           if(result.status == "success") {
                users_list = result.userList;
                // console.log(problem_list);
                fill_users();
            }
            else{
                layer.msg(result.message);
            }
        },
        error : function(){
            layer.msg("请求搜索失败！");
        }
    })
}

function fill_users(){
    if(users_list.length < 15){
        var tbody = document.getElementsByTagName('tbody')[0];
        $('tbody').html("");

        for(var i = 0; i < users_list.length; ++i){
            var user0 = users_list[i];

            if (user0.userGender == 1){
                user_gender="男"; 
            }
            else {
                user_gender = "女";
            }

            var tr = document.createElement('tr');

            var td1 = document.createElement('td');
            td1.style.textAlign = "center";
            td1.innerText = i+1;
            tr.appendChild(td1);

            var td2 = document.createElement('td');
            td2.style.textAlign = "center";
            td2.innerText = user0.userAccount;
            td2.style.wordWrap = "break-word";
            tr.appendChild(td2);   

            var td3 = document.createElement('td');
            td3.style.textAlign = "center";
            td3.innerText = user0.userNickname;
            tr.appendChild(td3);

           var td4 = document.createElement('td');
            td4.style.textAlign = "center";
            td4.innerText = user0.userAcademy;
            td4.style.wordWrap = "break-word";
            tr.appendChild(td4);

            var td5 = document.createElement('td');
            td5.style.textAlign = "center";
            td5.innerText = user0.userClass;
            td5.style.wordWrap = "break-word";
            tr.appendChild(td5);
     
            var td11 = document.createElement('td');
            td11.style.textAlign = "center";
            td11.innerText = user0.userName;
            td11.style.wordWrap = "break-word";
            tr.appendChild(td11);
            
            var td6 = document.createElement('td');
            td6.style.textAlign = "center";
            td6.innerText = user0.userTel;
            td6.style.wordWrap = "break-word";
            tr.appendChild(td6);

            var td8 = document.createElement('td');
            td8.style.textAlign = "center";
            td8.innerText = user0.userStudentnumber;
            td8.style.wordWrap = "break-word";
            tr.appendChild(td8);

            var td9 = document.createElement('td');
            td9.style.textAlign = "center";
            td9.innerText = user0.userEmail;
            td9.style.wordWrap = "break-word";
            tr.appendChild(td9);

            var td10 = document.createElement('td');
            td10.style.textAlign = "center";
            td10.innerText = user_gender;
            td10.style.wordWrap = "break-word";
            tr.appendChild(td10);

            var td7 = document.createElement('td');

            var a1 = document.createElement('a');
            a1.id = "editProblem" + (i+1);
            a1.className = "layui-btn layui-btn-normal layui-btn-xs";
            var i1 = document.createElement('i');
            i1.className = "layui-icon layui-icon-edit";
            a1.appendChild(i1);
            a1.innerHTML = a1.innerHTML + "编辑";
            a1.onclick = edit_user;
            td7.appendChild(a1);

            var a2 = document.createElement('a');
            a2.id = "delProblem" + (i+1);
            a2.className = "layui-btn layui-btn-danger layui-btn-xs";
            var i2 = document.createElement('i');
            i2.className = "layui-icon layui-icon-delete";
            a2.appendChild(i2);
            a2.innerHTML = a2.innerHTML + "删除";
            a2.onclick = del_problem;
            td7.style.textAlign = "center";
            td7.appendChild(a2);
            tr.appendChild(td7);

            tbody.appendChild(tr);
        }
    }

    else if(users_list.length >= 15){
        
        for(var j = 0; j < 15; ++j){
            var tbody = document.getElementsByTagName('tbody')[0];
            var user0 = users_list[j];

            if (user0.userGender == 1){
                user_gender="男"; 
            }
            else {
                user_gender = "女";
            }

            var tr = document.createElement('tr');

            var td1 = document.createElement('td');
            td1.style.textAlign = "center";
            td1.innerText = j+1;
            tr.appendChild(td1);

            var td2 = document.createElement('td');
            td2.style.textAlign = "center";
            td2.innerText = user0.userAccount;
            td2.style.wordWrap = "break-word";
            tr.appendChild(td2);   

            var td3 = document.createElement('td');
            td3.style.textAlign = "center";
            td3.innerText = user0.userNickname;
            tr.appendChild(td3);

           var td4 = document.createElement('td');
            td4.style.textAlign = "center";
            td4.innerText = user0.userAcademy;
            td4.style.wordWrap = "break-word";
            tr.appendChild(td4);

            var td5 = document.createElement('td');
            td5.style.textAlign = "center";
            td5.innerText = user0.userClass;
            td5.style.wordWrap = "break-word";
            tr.appendChild(td5);
     
            var td11 = document.createElement('td');
            td11.style.textAlign = "center";
            td11.innerText = user0.userName;
            td11.style.wordWrap = "break-word";
            tr.appendChild(td11);
            
            var td6 = document.createElement('td');
            td6.style.textAlign = "center";
            td6.innerText = user0.userTel;
            td6.style.wordWrap = "break-word";
            tr.appendChild(td6);

            var td8 = document.createElement('td');
            td8.style.textAlign = "center";
            td8.innerText = user0.userStudentnumber;
            td8.style.wordWrap = "break-word";
            tr.appendChild(td8);

            var td9 = document.createElement('td');
            td9.style.textAlign = "center";
            td9.innerText = user0.userEmail;
            td9.style.wordWrap = "break-word";
            tr.appendChild(td9);

            var td10 = document.createElement('td');
            td10.style.textAlign = "center";
            td10.innerText = user_gender;
            td10.style.wordWrap = "break-word";
            tr.appendChild(td10);

            var td7 = document.createElement('td');

            var a1 = document.createElement('a');
            a1.id = "editProblem" + (i+1);
            a1.className = "layui-btn layui-btn-normal layui-btn-xs";
            var i1 = document.createElement('i');
            i1.className = "layui-icon layui-icon-edit";
            a1.appendChild(i1);
            a1.innerHTML = a1.innerHTML + "编辑";
            a1.onclick = edit_user;
            td7.appendChild(a1);

            var a2 = document.createElement('a');
            a2.id = "delProblem" + (i+1);
            a2.className = "layui-btn layui-btn-danger layui-btn-xs";
            var i2 = document.createElement('i');
            i2.className = "layui-icon layui-icon-delete";
            a2.appendChild(i2);
            a2.innerHTML = a2.innerHTML + "删除";
            a2.onclick = del_problem;
            td7.style.textAlign = "center";
            td7.appendChild(a2);
            tr.appendChild(td7);

            tbody.appendChild(tr);
        }  //for(var i = 0; i < users_list.length; ++i){
        $("#paging").sPage({
            page:1,//当前页码，必填
            total:users_list.length,//数据总条数，必填
            pageSize:15,//每页显示多少条数据，默认10条
            totalTxt:'共'+users_list.length+'条',//数据总条数文字描述，{total}为占位符，默认"共{total}条"
            showTotal:false,//是否显示总条数，默认关闭：false
            showSkip:true,//是否显示跳页，默认关闭：false
            showPN:true,//是否显示上下翻页，默认开启：true
            prevPage:"上一页",//上翻页文字描述，默认“上一页”
            nextPage:"下一页",//下翻页文字描述，默认“下一页”
            backFun:function(page){
                $('tbody').html("");
                var lastpage = parseInt(users_list.length/15)+1;
                if(page<lastpage){
                    for(var k = (page-1)*15; k < page*15; k++){
                        var tbody = document.getElementsByTagName('tbody')[0];
                        var user0 = users_list[k];

                        if (user0.userGender == 1){
                            user_gender="男"; 
                        }
                        else {
                            user_gender = "女";
                        }

                        var tr = document.createElement('tr');

                        var td1 = document.createElement('td');
                        td1.style.textAlign = "center";
                        td1.innerText = k+1;
                        tr.appendChild(td1);

                        var td2 = document.createElement('td');
                        td2.style.textAlign = "center";
                        td2.innerText = user0.userAccount;
                        td2.style.wordWrap = "break-word";
                        tr.appendChild(td2);   

                        var td3 = document.createElement('td');
                        td3.style.textAlign = "center";
                        td3.innerText = user0.userNickname;
                        tr.appendChild(td3);

                        var td4 = document.createElement('td');
                        td4.style.textAlign = "center";
                        td4.innerText = user0.userAcademy;
                        td4.style.wordWrap = "break-word";
                        tr.appendChild(td4);

                        var td5 = document.createElement('td');
                        td5.style.textAlign = "center";
                        td5.innerText = user0.userClass;
                        td5.style.wordWrap = "break-word";
                        tr.appendChild(td5);
                 
                        var td11 = document.createElement('td');
                        td11.style.textAlign = "center";
                        td11.innerText = user0.userName;
                        td11.style.wordWrap = "break-word";
                        tr.appendChild(td11);
                        
                        var td6 = document.createElement('td');
                        td6.style.textAlign = "center";
                        td6.innerText = user0.userTel;
                        td6.style.wordWrap = "break-word";
                        tr.appendChild(td6);

                        var td8 = document.createElement('td');
                        td8.style.textAlign = "center";
                        td8.innerText = user0.userStudentnumber;
                        td8.style.wordWrap = "break-word";
                        tr.appendChild(td8);

                        var td9 = document.createElement('td');
                        td9.style.textAlign = "center";
                        td9.innerText = user0.userEmail;
                        td9.style.wordWrap = "break-word";
                        tr.appendChild(td9);
                        var td10 = document.createElement('td');
                        td10.style.textAlign = "center";
                        td10.innerText = user_gender;
                        td10.style.wordWrap = "break-word";
                        tr.appendChild(td10);

                        var td7 = document.createElement('td');

                        var a1 = document.createElement('a');
                        a1.id = "editProblem" + (i+1);
                        a1.className = "layui-btn layui-btn-normal layui-btn-xs";
                        var i1 = document.createElement('i');
                        i1.className = "layui-icon layui-icon-edit";
                        a1.appendChild(i1);
                        a1.innerHTML = a1.innerHTML + "编辑";
                        a1.onclick = edit_user;
                        td7.appendChild(a1);

                        var a2 = document.createElement('a');
                        a2.id = "delProblem" + (i+1);
                        a2.className = "layui-btn layui-btn-danger layui-btn-xs";
                        var i2 = document.createElement('i');
                        i2.className = "layui-icon layui-icon-delete";
                        a2.appendChild(i2);
                        a2.innerHTML = a2.innerHTML + "删除";
                        a2.onclick = del_problem;
                        td7.style.textAlign = "center";
                        td7.appendChild(a2);
                        tr.appendChild(td7);

                        tbody.appendChild(tr);
                    }
                }
                else if(page == lastpage){
                    for(var k = (page-1)*15; k < users_list.length; k++){
                        var tbody = document.getElementsByTagName('tbody')[0];
                        var user0 = users_list[k];

                        if (user0.userGender == 1){
                            user_gender="男"; 
                        }
                        else {
                            user_gender = "女";
                        }

                        var tr = document.createElement('tr');

                        var td1 = document.createElement('td');
                        td1.style.textAlign = "center";
                        td1.innerText = k+1;
                        tr.appendChild(td1);

                        var td2 = document.createElement('td');
                        td2.style.textAlign = "center";
                        td2.innerText = user0.userAccount;
                        td2.style.wordWrap = "break-word";
                        tr.appendChild(td2);   

                        var td3 = document.createElement('td');
                        td3.style.textAlign = "center";
                        td3.innerText = user0.userNickname;
                        tr.appendChild(td3);

                        var td4 = document.createElement('td');
                        td4.style.textAlign = "center";
                        td4.innerText = user0.userAcademy;
                        td4.style.wordWrap = "break-word";
                        tr.appendChild(td4);

                        var td5 = document.createElement('td');
                        td5.style.textAlign = "center";
                        td5.innerText = user0.userClass;
                        td5.style.wordWrap = "break-word";
                        tr.appendChild(td5);
                 
                        var td11 = document.createElement('td');
                        td11.style.textAlign = "center";
                        td11.innerText = user0.userName;
                        td11.style.wordWrap = "break-word";
                        tr.appendChild(td11);
                        
                        var td6 = document.createElement('td');
                        td6.style.textAlign = "center";
                        td6.innerText = user0.userTel;
                        td6.style.wordWrap = "break-word";
                        tr.appendChild(td6);

                        var td8 = document.createElement('td');
                        td8.style.textAlign = "center";
                        td8.innerText = user0.userStudentnumber;
                        td8.style.wordWrap = "break-word";
                        tr.appendChild(td8);

                        var td9 = document.createElement('td');
                        td9.style.textAlign = "center";
                        td9.innerText = user0.userEmail;
                        td9.style.wordWrap = "break-word";
                        tr.appendChild(td9);

                        var td10 = document.createElement('td');
                        td10.style.textAlign = "center";
                        td10.innerText = user_gender;
                        td10.style.wordWrap = "break-word";
                        tr.appendChild(td10);

                        var td7 = document.createElement('td');

                        var a1 = document.createElement('a');
                        a1.id = "editProblem" + (i+1);
                        a1.className = "layui-btn layui-btn-normal layui-btn-xs";
                        var i1 = document.createElement('i');
                        i1.className = "layui-icon layui-icon-edit";
                        a1.appendChild(i1);
                        a1.innerHTML = a1.innerHTML + "编辑";
                        a1.onclick = edit_user;
                        td7.appendChild(a1);

                        var a2 = document.createElement('a');
                        a2.id = "delProblem" + (i+1);
                        a2.className = "layui-btn layui-btn-danger layui-btn-xs";
                        var i2 = document.createElement('i');
                        i2.className = "layui-icon layui-icon-delete";
                        a2.appendChild(i2);
                        a2.innerHTML = a2.innerHTML + "删除";
                        a2.onclick = del_problem;
                        td7.style.textAlign = "center";
                        td7.appendChild(a2);
                        tr.appendChild(td7);

                        tbody.appendChild(tr);
                    }
                }
            }
        });
    }  //else if(users_list.length >= 15)

}
function  edit_user(){
    var tr = this.parentNode.parentNode;
    var num = tr.childNodes[0].innerText;
    var user = users_list[num-1];
    original_academychoice = user.userAcademy;
    original_genderchoice = user.userGender;

    layer.open({
        type: 1,
        offset: 'auto',
        skin: 'layui-layer-lan',
        id: 'layerDemo1', //防止重复弹出
        area: ['600px', '600px'],
        content:'<form class="layui-form" action="" style="margin:25px 0 0 15%; font-size:15px">\n' +
        
                '    <div class="layui-form-item">\n' +
                '       <label class="layui-form-label">用户名</label>\n' +
                '       <div class="layui-input-block">\n' +
                '        <input type="text" id="username" autocomplete="off" value="'+ user.userAccount+'" placeholder="请输入3-20位用户名" required class="layui-input layui-disabled" disabled style="width: 250px;" onchange="inputLimit()" onkeydown="inputLimit()" onkeyup="inputLimit()">\n' +
                '        </div>\n' +
                '    </div>\n' +
   
                '    <div class="layui-form-item">\n' +
                '    <label class="layui-form-label">新密码</label>\n' +
                '        <div class="layui-input-block">\n' +
                '            <input type="password" id="newpassword" placeholder="请输入3-20位密码" autocomplete="off" required value="'+ user.userPassword+'" lay-verify="password" class="layui-input" style="width: 250px;" onchange="inputLimit()" onkeydown="inputLimit()" onkeyup="inputLimit()">\n' +
                '        </div>\n' +
                '    </div>\n' +
                '   <div class="layui-form-item">\n' +
                '        <label class="layui-form-label">确认密码</label>\n' +
                '       <div class="layui-input-block">\n' +
                '           <input type="password" id="confirmPwd" placeholder="请确认密码" autocomplete="off" required value="'+ user.userPassword+'" lay-verify="password" class="layui-input" style="width: 250px;" onchange="inputLimit()" onkeydown="inputLimit()" onkeyup="inputLimit()" onblur="passwordLimit()">\n' +
                '       </div>\n' +
                '   </div>\n' +

                '   <div class="layui-form-item">\n' +
                '        <label class="layui-form-label">昵&nbsp;&nbsp;&nbsp;称</label>\n' +
                '       <div class="layui-input-block">\n' +
                '           <input type="text" id="nickname" autocomplete="off" required value="'+ user.userNickname+'" placeholder="请输入昵称" class="layui-input" style="width: 250px;" onchange="inputLimit()" onkeydown="inputLimit()" onkeyup="inputLimit()">\n' +
                '       </div>\n' +
                '   </div>  \n' +

                '   <div class="layui-form-item">\n' +
                '       <label class="layui-form-label">手机号</label>\n' +
                '       <div class="layui-input-block">\n' +
                '           <input type="text" id="phone" autocomplete="off" required value="'+ user.userTel+'" lay-verify="phone" placeholder="请输入手机号" class="layui-input" style="width: 250px;" onchange="inputLimit()" onkeydown="inputLimit()" onkeyup="inputLimit()">\n' +
                '       </div>\n' +
                '   </div>\n' +

                '   <div class="layui-inline layui-form-item" style="margin-top:1%" id="academys">\n' +
                '       <label class="layui-form-label">学院</label>\n' +
                '       <div class="layui-input-inline" id="academy">\n' +
                '           <select name="module" >\n' +
                '               <option value="">请选择学院</option>\n' +
                '               <option value="杭州国际服务工程学院" id="杭州国际服务工程学院">杭州国际服务工程学院</option>\n' +
                '               <option value="理学院" id="理学院">理学院</option>\n' +
                '               <option value="文化创意学院" id="文化创意学院">文化创意学院</option>\n' +
                '               <option value="外国语学院" id="外国语学院">外国语学院</option>\n' +
                '               <option value="政治与社会学院" id="政治与社会学院">政治与社会学院</option>\n' +
                '               <option value="经济与管理学院" id="经济与管理学院">经济与管理学院</option>\n' +
                '               <option value="沈钧儒法学院" id="沈钧儒法学院">沈钧儒法学院</option>\n' +
                '               <option value="教育学院" id="教育学院">教育学院</option>\n' +
                '               <option value="医学院" id="医学院">医学院</option>\n' +
                '               <option value="材料与化学化工学院" id="材料与化学化工学院">材料与化学化工学院</option>\n' +
                '               <option value="阿里巴巴商学院" id="阿里巴巴商学院">阿里巴巴商学院</option>\n' +
                '               <option value="经亨颐学院" id="经亨颐学院">经亨颐学院</option>\n' +
                '               <option value="生命与环境科学学院" id="生命与环境科学学院">生命与环境科学学院</option>\n' +
                '               <option value="体育与健康学院" id="体育与健康学院">体育与健康学院</option>\n' +
                '               <option value="美术学院" id="美术学院">美术学院</option>\n' +
                '               <option value="人文学院" id="人文学院">人文学院</option>\n' +
                '           </select>\n' +
                '       </div>\n' +
                '   </div> \n' +

                '    <div class="layui-form-item">\n' +
                '        <label class="layui-form-label">班级</label>\n' +
                '        <div class="layui-input-block">\n' +
                '            <input type="text" id="Class" autocomplete="off" required value="'+ user.userClass+'" lay-verify="phone" placeholder="请输入班级" class="layui-input" style="width: 250px;" onchange="inputLimit()" onkeydown="inputLimit()" onkeyup="inputLimit()">\n' +
                '        </div>\n' +
                '    </div>\n' +

                '    <div class="layui-form-item">\n' +
                '       <label class="layui-form-label">真实姓名</label>\n' +
                '        <div class="layui-input-block">\n' +
                '        <input type="text" id="name" autocomplete="off"  value="'+ user.userName+'" placeholder="请输入1-18位中文" required class="layui-input" style="width: 250px;" onchange="inputLimit()" onkeydown="inputLimit()" onkeyup="inputLimit()"> \n' +
                '        </div>\n' +
                '    </div>\n' +

                '    <div class="layui-form-item">\n' +
                '       <label class="layui-form-label">学号</label>\n' +
                '        <div class="layui-input-block">\n' +
                '       <input type="text" id="studentnumber" autocomplete="off" value="'+ user.userStudentnumber+'" placeholder="请输入学号" required class="layui-input" style="width: 250px;" onchange="inputLimit()" onkeydown="inputLimit()" onkeyup="inputLimit()"> \n' +
                '       </div>\n' +
                '    </div>\n' +

                '    <div class="layui-form-item">\n' +
                '        <label class="layui-form-label">邮&nbsp;&nbsp;&nbsp;箱</label>\n' +
                '       <div class="layui-input-block">\n' +
                '            <input type="text" id="email" autocomplete="off" value="'+ user.userEmail+'" lay-verify="email" placeholder="请输入邮箱" class="layui-input" style="width: 250px;" onchange="inputLimit()" onkeydown="inputLimit()" onkeyup="inputLimit()">\n' +
                '        </div>\n' +
                '    </div>\n' +
                    
                '    <div class="layui-form-item">\n' +
                '        <label class="layui-form-label">性&nbsp;&nbsp;&nbsp;别</label>\n' +
                '        <div class="layui-input-block">\n' +

                '            <input name="sex" title="男" type="radio" value="男" id="1">\n' +
                '            <div class="layui-unselect layui-form-radio layui-form-radioed">\n' +
                '                <i class="layui-anim layui-icon"></i>\n' +
                '                <div>男</div>\n' +
                '            </div>\n' +

                '            <input name="sex" title="女" type="radio" value="女" id="0">\n' +
                '            <div class="layui-unselect layui-form-radio">\n' +
                '                <i class="layui-anim layui-icon"></i>\n' +
                '                <div>女</div>\n' +
                '            </div>\n' +

                '        </div>\n' +
                '    </div>\n' +



        '</form>' +
        '<script>\n' +
        '    layui.use(\'form\', function(){\n' +
        '                var form = layui.form;\n' +
        '                fillgenderSelect();\n' +    
        '                fillacademySelect();\n'+
        '                form.render();\n' +
        '                form.verify();\n' +
        '            });\n' +
        '    layui.use(\'element\', function(){\n' +
        '        var element = layui.element; \n' +//导航的hover效果、二级菜单等功能，需要依赖element模块
                //监听导航点击
        '        element.on(\'nav(demo)\', function(elem){\n' +
        '            //console.log(elem)\n' +
        '            layer.msg(elem.text());\n' +
        '        });\n' +
        '    });\n' +
        '</script>',
        btn: ['确定', '取消'],
        btnAlign: 'c',
        shade: 0.5,
        title: "更新题目信息",
        btn1 : function () {
            check_user(user);
            return false;
        },
        btn2 : function () {
            layer.closeAll();
        }
    });
}

function fillacademySelect(){
   var select = document.getElementsByName("module")[0];
   //console.log(select);
   for(var i = 0; i < users_list.length; ++i){
        if (original_academychoice == "杭州国际服务工程学院"){
            $("#杭州国际服务工程学院").attr("selected","selected");
        }
        else if(original_academychoice == "理学院"){
            $("#理学院").attr("selected","selected");
        }
        else if(original_academychoice == "文化创意学院"){
            $("#文化创意学院").attr("selected","selected");
        }
        else if(original_academychoice == "外国语学院"){
            $("#外国语学院").attr("selected","selected");
        }
        else if(original_academychoice == "政治与社会学院"){
            $("#政治与社会学院").attr("selected","selected");
        }
        else if(original_academychoice == "经济与管理学院"){
            $("#经济与管理学院").attr("selected","selected");
        }
        else if(original_academychoice == "沈钧儒法学院"){
            $("#沈钧儒法学院").attr("selected","selected");
        }
        else if(original_academychoice == "教育学院"){
            $("#教育学院").attr("selected","selected");
        }
        else if(original_academychoice == "医学院"){
            $("#医学院").attr("selected","selected");
        }
        else if(original_academychoice == "材料与化学化工学院"){
            $("#材料与化学化工学院").attr("selected","selected");
        }
        else if(original_academychoice == "阿里巴巴商学院"){
            $("#阿里巴巴商学院").attr("selected","selected");
        }
        else if(original_academychoice == "经亨颐学院"){
            $("#经亨颐学院").attr("selected","selected");
        }
        else if(original_academychoice == "生命与环境科学学院"){
            $("#生命与环境科学学院").attr("selected","selected");
        }
        else if(original_academychoice == "体育与健康学院"){
            $("#体育与健康学院").attr("selected","selected");
        }
        else if(original_academychoice == "美术学院"){
            $("#美术学院").attr("selected","selected");
        }
        else if(original_academychoice == "人文学院"){
            $("#人文学院").attr("selected","selected");
        }
    }
}

function passwordLimit(){
    var input = window.event.target;
    input.value = input.value.substring(0,16); if(window.event.keyCode == 13) return false;
    var pwd = document.getElementById("newpassword");
    if(pwd.value.toString() != input.value.toString()){
        layer.tips("两次密码不相同！", "#confirmPwd");
    }
}


function fillgenderSelect(){
    for(var i = 0; i < users_list.length; ++i){
        if (original_genderchoice == 0 ){
            $("#0").attr("checked","checked");
        }
        else if(original_genderchoice == 1 ){
            $("#1").attr("checked","checked");
        }
    }
}

function check_user(user){
    user_username = document.getElementById('username').value;
    user_newpwd = document.getElementById('newpassword').value;
    user_comfirmPwd = document.getElementById('confirmPwd').value;
    user_nickname = document.getElementById('nickname').value;
    user_academy = $("#academys").find('.layui-this').attr("lay-value");
    user_class = document.getElementById('Class').value;
    user_name = document.getElementById('name').value;
    user_tel = document.getElementById('phone').value;
    user_number = document.getElementById('studentnumber').value;
    user_email = document.getElementById('email').value;
    user_gender = $("input[name='sex']:checked").val();
    //console.log(problem_type);
    //console.log(problem_towho);
    //将题目类型的中文说明转换为对应的数字
    
    var reg1 = /^[A-Za-z0-9]{3,20}$/;  //用户名密码3-20位字符
    var reg2 = /^[0-9]{11}$/;  //手机号码
    var reg3 = /^[0-9]{13}$/; //学号13位数字
    var reg4 = /^[\u4e00-\u9fa5]{1,18}$/;  //真实姓名1-18个中文
    var reg5= /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;  //邮箱


    if(user_username == "" || user_username == null){
        //document.getElementById("tips").innerHTML="用户名不能为空！";
        layer.msg("用户名不能为空！");
    }
    else if(!reg1.test(user_username)){
        layer.msg("用户名不合法,3-20位字符组合");
    }

    else if(user_newpwd == null || user_newpwd == ""){
        layer.msg("新密码不能为空！");
    }
    else if(!reg1.test(user_newpwd)){
        layer.msg("新密码不合法，3-20位字符组合");
    }

    else if(user_comfirmPwd == null || user_comfirmPwd == ""){
        layer.msg("请再次输入密码！");
    }
    else if(user_comfirmPwd != user_newpwd){
        layer.msg("两次密码不相同！");
    }

    else if(user_nickname == "" || user_nickname == null){
        layer.msg("昵称不能为空！" );
    }

    else if(user_tel == "" || user_tel == null){
        layer.msg("手机号不能为空！");
    }
    else if(!reg2.test(user_tel)){
        layer.msg("请注意手机号格式！");
    }

    else if(user_academy == "" || user_academy == null){
        layer.msg("学院不能为空！");
    }

    else if(user_class == "" || user_class == null){
        layer.msg("班级不能为空！");
    }

    else if(user_name == "" || user_name == null){
        layer.msg("真实姓名不能为空");
    }
    else if(!reg4.test(user_name)){
        layer.msg("真实姓名不合法,2-15位中文");
    }

    else if(user_number == null || user_number == ""){
        layer.msg("学号不能为空！！");
    }  
    else if(!reg3.test(user_number)){
        layer.msg("学号不合法,13位数字");
    }

    else if(user_email == "" || user_email == null){
        layer.msg("邮箱不能为空！");
    }
    else if(!reg5.test(user_email)){
        layer.msg("邮箱格式不合法");
    }

    else if(user_gender == null || user_gender == ""){
        layer.msg("性别不能为空！");
    }

    else{
        var gender;
        if(user_gender == '男'){
            gender = 1;
        }else{
            gender = 0;
        }
        update_Problem(user_username,user_nickname, user_academy,  user_class, user_name, user_tel, user_number, user_email, gender,  user_newpwd );
    }
}

function update_Problem(user_username,user_nickname, user_academy,  user_class, user_name, user_tel, user_number, user_email, user_gender, user_newpwd ){
    // console.log(mydata);
    $.ajax({
        url : '../../../user/update', //编辑更新用户信息
        data :{ 
              "userAccount" : user_username,
              "userPassword" : user_newpwd,
              "userNickname" : user_nickname,
              "userAcademy" : user_academy,
              "userClass" : user_class,
              "userName" : user_name,
              "userTel" : user_tel,
              "userEmail" : user_email,
              "userGender" : parseInt(user_gender),
              "userStudentnumber" : user_number
              },
        type : 'post',
        scriptCharset : 'utf-8',
        success : function(result){
            if(result.status== "success"){
                layer.open({
                    type: 1,
                    offset: 'auto',
                    id: 'layerDemo2', //防止重复弹出
                    content: '<div style="padding: 20px 100px;">' + "更新成功！" + '</div>',
                    btn: '关闭',
                    btnAlign: 'c', //按钮居中
                    shade: 0.5, //不显示遮罩
                    title: "HZNUCTF",
                    yes: function () {
                        layer.closeAll();
                    }
                });
                get_users();
            }
            else {
                layer.msg(result.message);
            }
        },
        error : function(){
            layer.msg("请求接口失败");
        }
    });
}

function del_problem(){
    var tr = this.parentNode.parentNode;
    var num = tr.childNodes[0].innerText;
    var user = users_list[num-1];
    layer.open({
        type: 1,
        offset: 'auto', 
        id: 'layerDemo1', //防止重复弹出
        content: '<div style="padding: 20px 50px;">' + "确定删除 "+ user.userAccount + "用户吗吗？" + '</div>',
        btn: ['确定', '取消'],
        btnAlign: 'c', //按钮居中
        shade: 0.5, //不显示遮罩
        title: "删除用户",
        btn1 : function () {
            delProblem(user);
            return false;
        },
        btn2 : function () {
            layer.closeAll();
        }
    });
}

function delProblem(user){
    var username = user.userAccount;
    $.ajax({
        url : '../../../user/delete', //删除用户
        data : {"userAccount" : username },
        scriptCharset : "utf-8",
        type : "post",
        success : function(result){
            if(result.status == "success"){
                layer.open({
                    type: 1,
                    offset: 'auto',
                    id: 'layerDemo2', //防止重复弹出
                    content: '<div style="padding: 20px 100px;">' + "删除成功！" + '</div>',
                    btn: '关闭',
                    btnAlign: 'c', //按钮居中
                    shade: 0.5, //不显示遮罩
                    title: "HZNUCTF",
                    yes: function () {
                        layer.closeAll();
                    }
                });
                get_users();
            }
            else {
                layer.msg(result.message);
                window.location.reload();
            }
        },
        error : function(){
            layer.msg("请求接口失败");
        }
    });
}


function textarea_fun(){
    $(".tcp_content").val($(".tcp_content").val().substring(0,500));
    $(".t_h i").html($(".tcp_content").val().length);
    if(window.event.keyCode  == 13){
        return false;
    }
}

/*      j=i+1;
        var content = '<tr>'+
        '    <td style="text-align: center;">'+ j +' </td>'+
        '    <td style="text-align: center; overflow-wrap: break-word;"> '+ user0.username+'  </td>'+
        '    <td style="text-align: center;"> '+ user0.nickname+' </td>'+ 

        '    <td style="text-align: center; overflow-wrap: break-word;"> '+ user0.academy+'  </td>'+
        '    <td style="text-align: center; overflow-wrap: break-word;"> '+ user0.class+'  </td>'+
        '    <td style="text-align: center; overflow-wrap: break-word;"> '+ user0.name+'  </td>'+

        '    <td style="text-align: center; overflow-wrap: break-word;"> '+ user0.tel+'  </td>'+
        '    <td style="text-align: center; overflow-wrap: break-word;"> '+ user0.number+'  </td>'+
        '    <td style="text-align: center; overflow-wrap: break-word;"> '+ user0.email+'  </td>'+
        '    <td style="text-align: center; overflow-wrap: break-word;"> '+ user_gender+'  </td>'+
        
        '    <td style="text-align: center; padding : 0px;"> '+
        '        <a class="layui-btn layui-btn-normal layui-btn-xs" onclick = "edit_user('+user0.competitionquestionId+')";>'+
        '            <i class="layui-icon layui-icon-edit"></i>'+
        '            "编辑"'+
        '        </a>'+
 
        '        <a class="layui-btn layui-btn-danger layui-btn-xs" onclick = "del_problem('+user0.competitionquestionId+')";>'+
        '            <i class="layui-icon layui-icon-delete"></i>'+
        '            "删除"'+
        '        </a>'+
        '    </td>'+
        '</tr>'
        $("tbody").append(content);*/